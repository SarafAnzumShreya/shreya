{{/* Render a responsive page image; accept image or featured, string or object */}}
{{ $img := index .Params "image" }}
{{ if not $img }}{{ $img = index .Params "featured" }}{{ end }}
{{ if $img }}
  {{ if eq (printf "%T" $img) "string" }}
    {{ $img = dict "filename" $img }}
  {{ end }}
  {{ $src := (index $img "url") | default (index $img "src") | default (index $img "filename") }}
  {{ if $src }}
    {{ if not (strings.HasPrefix $src "http") }}{{ $src = $src | relURL }}{{ end }}
    <figure class="page-image">
      <img
        class="page-image__img"
        src="{{ $src }}"
        alt="{{ (index $img "alt") | default .Title }}"
        loading="lazy"
        decoding="async"
      />
      {{ with index $img "caption" }}
        <figcaption class="page-image__caption">{{ . }}</figcaption>
      {{ end }}
    </figure>
  {{ end }}
{{ end }}